{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}{% endblock %}</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link rel="stylesheet" href="{% static 'css/base.css' %}">
    </head>
    <body>
        <header>
            <nav class="navbar navbar-dark bg-dark navbar-expand-md px-4">
                <a href="{% url 'pages:home' %}" class="navbar-brand">Django EC Site</a>
                <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navLinks">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navLinks">
                    <form class="d-flex" method="get">
                        <input class="form-control me-2" type="search" name="search" value="{{ request.GET.search|default:'' }}" placeholder="タイトルまたは著者名で検索" aria-label="Search">
                        <button class="btn btn-outline-light text-nowrap" type="submit">キーワード検索</button>
                    </form>
                    <div class="navbar-nav ms-auto">
                        <a href="{% url "carts:cart" %}" class="nav-item nav-link"><i class="bi bi-cart"></i> 買い物かご</a>
                        <a href="{% url "accounts:favorite_list" %}" class="nav-item nav-link"><i class="bi bi-heart"></i> お気に入り</a>
                        <a href="{% url "accounts:order_history" %}" class="nav-item nav-link"><i class="bi bi-card-list"></i> 購入履歴</a>
                        <a href="{% url "accounts:mypage" %}" class="nav-item nav-link"><i class="bi bi-person"></i> マイページ</a>
                        {% if user.is_authenticated %}
                        <a href="{% url "account_logout" %}" class="nav-item nav-link">ログアウト</a>
                        {% else %}
                        <a href="{% url "account_login" %}" class="nav-item nav-link">ログイン</a>
                        {% endif %}
                    </div>
                </div>
            </nav>
        </header>        
        <div class="container d-flex pt-4">
            <nav class="sidebar d-none d-md-block me-3">
                <div class="card">
                    <div class="card-header">
                        カテゴリ
                    </div>
                    <div class="card-body">
                        <ul class="navbar-nav flex-column">
                        {% for category in categories %}
                        <li class="nav-item">
                            <a class="nav-link{% if request.resolver_match.kwargs.category == category.name %} active{% endif %}" href="{% url 'products:book_list' category.name %}"><small>{{ category.name }}</small></a>
                        </li>
                        {% endfor %}
                        </ul>
                    </div>
                </div>
            </nav>
            <main class="w-100">
                {% block content %}
                {% endblock %}
            </main>
        </div>
        
        <!-- ===== フッター ===== -->
        <footer class="bg-dark text-light text-center p-3 mt-4">
            <p class="mb-0">&copy; 2025 Django EC Site</p>
        </footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    </body>
</html>