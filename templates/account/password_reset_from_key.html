{% extends "base.html" %}

{% load i18n %}
{% load allauth %}
{% load widget_tweaks %}

{% block title %}
    パスワードリセット
{% endblock %}
{% block content %}
    {% element h1 %}
        {% if token_fail %}
            {% trans "Bad Token" %}
        {% else %}
            パスワードリセット
        {% endif %}
    {% endelement %}
    {% if token_fail %}
        {% url 'account_reset_password' as passwd_reset_url %}
        {% element p %}
            {% blocktrans %}このパスワードリセットリンクは無効か、すでに使用されています。<a href="{{ passwd_reset_url }}">こちら</a>から新しいリンクをリクエストしてください。{% endblocktrans %}
        {% endelement %}
    {% else %}
        <form method="post">
            {% csrf_token %}
            <label for="{{ form.password1.id_for_label }}">{{ form.password1.label }}</label>
            {{ form.password1|add_class:"form-control mb-3" }}
            {% for error in form.password1.errors %}
                <small class="text-danger d-block">{{ error }}</small>
            {% endfor %}
            <small id="id_password1_helptext">
                <ul class="list-unstyled">
                    <li>パスワードは個人情報と似すぎないようにしてください。</li>
                    <li>8 文字以上で設定してください。</li>
                    <li>よく使われる簡単なパスワードは使用できません。</li>
                    <li>数字だけのパスワードは使用できません</li>
                </ul>
            </small>
            <label for="{{ form.password2.id_for_label }}">{{ form.password2.label }}</label>
            {{ form.password2|add_class:"form-control mb-3" }}
            {% for error in form.password2.errors %}
                <small class="text-danger d-block">{{ error }}</small>
            {% endfor %}
            <button class="btn btn-primary" type="submit">パスワードリセット</button>
            <button form="logout-from-stage" class="btn btn-secondary" type="submit">
                キャンセル
            </button>
        </form>
    {% endif %}
    {% if not cancel_url %}
        <form id="logout-from-stage"
              method="post"
              action="{% url 'account_logout' %}">
            <input type="hidden" name="next" value="{% url 'account_login' %}">
            {% csrf_token %}
        </form>
    {% endif %}
{% endblock content %}
